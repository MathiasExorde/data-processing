SELECT 
    TIME_FLOOR(CAST("__time" AS TIMESTAMP), 'PT15M') AS "__time",
    count(*) as "volume",
    domain as "domain",
    source_type as "source_type",
    avg("sentiment") as "sentiment",
    avg("emotion_excitement") as "avg_emotion_excitement",
    sum("emotion_excitement") AS "sum_emotion_excitement",
    avg("emotion_anger") as "avg_emotion_anger",
    sum("emotion_anger") AS "sum_emotion_anger",
    avg("emotion_optimism") as "avg_emotion_optimism",
    sum("emotion_optimism") AS "sum_emotion_optimism",
    avg("emotion_fear") as "avg_emotion_fear",
    sum("emotion_fear") AS "sum_emotion_fear",
    avg("emotion_gratitude") as "avg_emotion_gratitude",
    sum("emotion_gratitude") AS "sum_emotion_gratitude",
    avg("emotion_joy") as "avg_emotion_joy",
    sum("emotion_joy") AS "sum_emotion_joy",
    avg("emotion_admiration") as "avg_emotion_admiration",
    sum("emotion_admiration") AS "sum_emotion_admiration",
    avg("emotion_annoyance") as "avg_emotion_annoyance",
    sum("emotion_annoyance") AS "sum_emotion_annoyance",
    avg("emotion_approval") as "avg_emotion_approval",
    sum("emotion_approval") AS "sum_emotion_approval",
    avg("emotion_nervousness") as "avg_emotion_nervousness",
    sum("emotion_nervousness") AS "sum_emotion_nervousness",
    avg("emotion_realization") as "avg_emotion_realization",
    sum("emotion_realization") AS "sum_emotion_realization",
    avg("emotion_relief") as "avg_emotion_relief",
    sum("emotion_relief") AS "sum_emotion_relief",
    avg("emotion_love") as "avg_emotion_love",
    sum("emotion_love") AS "sum_emotion_love",
    avg("emotion_sadness") as "avg_emotion_sadness",
    sum("emotion_sadness") AS "sum_emotion_sadness",
    avg("emotion_disgust") as "avg_emotion_disgust",
    sum("emotion_disgust") AS "sum_emotion_disgust",
    avg("emotion_disapproval") as "avg_emotion_disapproval",
    sum("emotion_disapproval") AS "sum_emotion_disapproval",
    avg("emotion_embarrassment") as "avg_emotion_embarrassment",
    sum("emotion_embarrassment") AS "sum_emotion_embarrassment",
    avg("emotion_pride") as "avg_emotion_pride",
    sum("emotion_pride") AS "sum_emotion_pride",
    avg("emotion_caring") as "avg_emotion_caring",
    sum("emotion_caring") AS "sum_emotion_caring",
    avg("emotion_remorse") as "avg_emotion_remorse",
    sum("emotion_remorse") AS "sum_emotion_remorse",
    avg("emotion_grief") as "avg_emotion_grief",
    sum("emotion_grief") AS "sum_emotion_grief",
    avg("emotion_curiosity") as "avg_emotion_curiosity",
    sum("emotion_curiosity") AS "sum_emotion_curiosity",
    avg("emotion_desire") as "avg_emotion_desire",
    sum("emotion_desire") AS "sum_emotion_desire",
    avg("emotion_disappointment") as "avg_emotion_disappointment",
    sum("emotion_disappointment") AS "sum_emotion_disappointment"
FROM "druid"."posts"
WHERE "__time" >= '2023-10-17 00:00:00.000000'
    AND "topics" IN ('4201')
GROUP BY TIME_FLOOR(CAST("__time" AS TIMESTAMP), 'PT15M'), domain, source_type
